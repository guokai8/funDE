% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_families.R
\name{analyze_families}
\alias{analyze_families}
\title{Gene Family-level Differential Expression Analysis}
\usage{
analyze_families(
  counts,
  metadata,
  design,
  contrast = NULL,
  families = "HGNC",
  species = "human",
  aggregation_method = "mean",
  min_family_size = 2,
  max_family_size = 100,
  method = "DESeq2",
  filter_low_counts = TRUE,
  min_count = 10,
  alpha = 0.05,
  ...
)
}
\arguments{
\item{counts}{A matrix of raw counts (genes x samples)}

\item{metadata}{A data.frame containing sample information}

\item{design}{A formula specifying the design matrix}

\item{contrast}{Character vector of length 3: c("variable", "level1", "level2")}

\item{families}{Character database name or named list or data.frame of gene families}

\item{species}{Character, "human" or "mouse" (used when families is a database name)}

\item{aggregation_method}{Method for aggregating genes: "mean" (default), "median", "sum"}

\item{min_family_size}{Minimum genes required in family (default: 2)}

\item{max_family_size}{Maximum genes allowed in family (default: 100)}

\item{method}{Method for DE analysis: "DESeq2" (default), "edgeR", "limma"}

\item{filter_low_counts}{Logical, filter lowly expressed families (default: TRUE)}

\item{min_count}{Minimum count threshold for filtering (default: 10)}

\item{alpha}{Significance threshold (default: 0.05)}

\item{...}{Additional arguments passed to DE method}
}
\value{
A list of class "functionalDE_result" containing:
  \item{results}{Data.frame with family-level DE statistics}
  \item{family_counts}{Aggregated count matrix at family level}
  \item{families_used}{Gene family mappings used}
  \item{gene_mapping}{Mapping from genes to families}
  \item{counts_raw}{Original gene-level counts}
  \item{metadata}{Sample metadata}
  \item{method}{Method used}
  \item{params}{Parameters used}
  \item{summary}{Summary statistics}
}
\description{
Performs differential expression analysis at the gene family level by
aggregating related genes and testing for coordinated changes. This can
detect functional changes that might be missed at individual gene level.
}
\details{
**Gene Family Sources:**

*HGNC (Human Gene Nomenclature Committee):*
- Authoritative gene family classifications
- Based on sequence similarity and function
- Available for human genes

*Custom families:*
- User-provided gene groupings
- Can be functional groups, protein complexes, etc.
- Provided as named list or data.frame

**Aggregation Methods:**

*Mean:*
- Average expression across family members
- Good for detecting overall family activity
- Reduces noise from individual genes

*Median:*
- More robust to outliers
- Less sensitive to highly variable family members

*Sum:*
- Total family expression
- Appropriate for count data
- Maintains count distributions

**Biological Interpretation:**
- Family-level changes suggest coordinated regulation
- Can detect compensation effects within families
- May reveal functional changes missed at gene level
- Consider both family-level and gene-level results
}
\examples{
# Basic family analysis with HGNC families
family_results <- analyze_families(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control"),
  families = "HGNC",
  species = "human"
)

# View results
head(family_results$results)
summary(family_results)

# With custom families
custom_families <- list(
  "Ribosomal_proteins" = c("RPS1", "RPS2", "RPL1", "RPL2"),
  "Heat_shock_proteins" = c("HSP90AA1", "HSP90AB1", "HSPA1A", "HSPA1B"),
  "Immunoglobulins" = c("IGHG1", "IGHG2", "IGHA1", "IGHA2")
)

family_results <- analyze_families(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control"),
  families = custom_families,
  aggregation_method = "sum"
)

}
\seealso{
\code{\link{get_gene_families}}, \code{\link{analyze_genes}}, \code{\link{analyze_pathways}}
}
