% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_genes.R
\name{analyze_genes}
\alias{analyze_genes}
\title{Gene-level Differential Expression Analysis}
\usage{
analyze_genes(
  counts,
  metadata,
  design,
  contrast = NULL,
  method = "DESeq2",
  filter_low_counts = TRUE,
  min_count = 10,
  min_samples = 2,
  alpha = 0.05,
  lfc_threshold = 0,
  transform_method = "log2",
  parallel = FALSE,
  ...
)
}
\arguments{
\item{counts}{A matrix of raw counts (genes x samples)}

\item{metadata}{A data.frame containing sample information with rownames matching colnames of counts}

\item{design}{A formula specifying the design matrix (e.g., ~ condition)}

\item{contrast}{Character vector of length 3: c("variable", "level1", "level2") where level1 is compared to level2}

\item{method}{Method for DE analysis: "DESeq2" (default), "edgeR", or "limma"}

\item{filter_low_counts}{Logical, whether to filter lowly expressed genes (default: TRUE)}

\item{min_count}{Minimum count threshold for filtering (default: 10)}

\item{min_samples}{Minimum number of samples that must have min_count (default: 2)}

\item{alpha}{Significance threshold for adjusted p-values (default: 0.05)}

\item{lfc_threshold}{Log2 fold change threshold for significance (default: 0)}

\item{transform_method}{Method for count transformation: "log2", "rlog", "vst" (default: "log2")}

\item{parallel}{Logical, use parallel processing when available (default: FALSE)}

\item{...}{Additional arguments passed to the DE method}
}
\value{
A list of class "functionalDE_result" containing:
  \item{results}{Data.frame with DE statistics for each gene}
  \item{counts_raw}{Original count matrix}
  \item{counts_filtered}{Filtered count matrix}
  \item{counts_normalized}{Normalized count matrix}
  \item{counts_transformed}{Transformed count matrix for visualization}
  \item{metadata}{Sample metadata used}
  \item{design}{Design formula used}
  \item{contrast}{Contrast specification used}
  \item{method}{Method used for analysis}
  \item{params}{List of parameters used}
  \item{summary}{Summary statistics}
}
\description{
Performs differential expression analysis at the gene level using DESeq2,
edgeR, or limma. This is the foundation for all higher-level analyses in funDE.
}
\details{
**Methods:**

*DESeq2:*
- Recommended for most RNA-seq datasets
- Handles count data with negative binomial model
- Built-in normalization and shrinkage
- Best for datasets with replicates

*edgeR:*
- Good for datasets with fewer replicates
- Quasi-likelihood framework
- Robust dispersion estimation
- Fast and memory efficient

*limma:*
- Uses voom transformation for count data
- Linear modeling framework
- Good for complex experimental designs
- Handles missing values well

**Results Interpretation:**
- log2FoldChange: log2(level1/level2), positive = upregulated in level1
- padj: Benjamini-Hochberg adjusted p-values
- baseMean: Average normalized expression across all samples
- stat: Test statistic from the chosen method
}
\examples{
# Basic analysis with DESeq2
results <- analyze_genes(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control")
)

# View results
head(results$results)
summary(results)

# Get significant genes
sig_genes <- results$results \%>\%
  filter(padj < 0.05, abs(log2FoldChange) > 1)

# With edgeR and different parameters
results_edger <- analyze_genes(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control"),
  method = "edgeR",
  min_count = 5,
  lfc_threshold = 0.5
)

}
\seealso{
\code{\link{analyze_families}}, \code{\link{analyze_pathways}}
}
