% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_enrichment.R
\name{test_enrichment}
\alias{test_enrichment}
\title{Test Gene Set Enrichment}
\usage{
test_enrichment(
  genes,
  universe,
  gene_sets,
  method = "hypergeometric",
  min_set_size = 5,
  max_set_size = 500,
  p_adjust_method = "BH"
)
}
\arguments{
\item{genes}{Character vector of gene symbols or IDs (e.g., DE genes)}

\item{universe}{Character vector of all genes in the analysis (background)}

\item{gene_sets}{Named list of gene sets (e.g., from get_pathways())}

\item{method}{Character, statistical test: "hypergeometric" (default) or "fisher"}

\item{min_set_size}{Minimum genes in a set (default: 5)}

\item{max_set_size}{Maximum genes in a set (default: 500)}

\item{p_adjust_method}{Method for p-value adjustment: "BH" (default), "bonferroni", "fdr"}
}
\value{
Data.frame with columns:
  \item{gene_set}{Name of gene set}
  \item{set_size}{Total genes in set}
  \item{overlap}{Number of genes overlapping with input}
  \item{genes}{Comma-separated list of overlapping genes}
  \item{pvalue}{Raw p-value}
  \item{padj}{Adjusted p-value}
  \item{odds_ratio}{Enrichment odds ratio}
  \item{expected}{Expected overlap by chance}
  \item{enrichment}{Observed to Expected ratio}
}
\description{
Performs enrichment analysis on a list of genes using hypergeometric test
or Fisher's exact test. This replaces clusterProfiler functionality with
a simpler, more transparent implementation.
}
\details{
**Statistical Methods:**

*Hypergeometric Test:*
- Tests over-representation of gene set in input genes
- More conservative, appropriate for most cases
- Formula: P(X >= k) where k is observed overlap

*Fisher's Exact Test:*
- Two-sided test
- Tests both enrichment and depletion
- Provides odds ratio estimate

**Biological Interpretation:**
- padj < 0.05: Significant enrichment
- enrichment > 1: Over-represented (more than expected by chance)
- enrichment < 1: Under-represented
- Large overlap with small set_size: Highly specific enrichment
}
\examples{
# Get significant genes
gene_results <- analyze_genes(...)
sig_genes <- gene_results$results \%>\%
  filter(padj < 0.05) \%>\%
  pull(gene)

# Get pathways
pathways <- get_pathways("Hallmark", species = "human")

# Test enrichment
enrichment <- test_enrichment(
  genes = sig_genes,
  universe = rownames(gene_results$results),
  gene_sets = pathways,
  method = "hypergeometric"
)

# View top enriched pathways
head(enrichment)

# Visualize
plot_enrichment(enrichment, top_n = 20)

}
\seealso{
\code{\link{get_pathways}}, \code{\link{plot_enrichment}}
}
