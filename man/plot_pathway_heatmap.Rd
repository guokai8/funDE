% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_pathway_heatmap.R
\name{plot_pathway_heatmap}
\alias{plot_pathway_heatmap}
\title{Plot Pathway Activity Heatmap}
\usage{
plot_pathway_heatmap(
  pathway_results,
  metadata = NULL,
  top_n = 20,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  annotation_cols = NULL,
  color_scheme = "RdBu",
  scale = "row",
  show_pathway_names = TRUE,
  fontsize_row = 8,
  fontsize_col = 8,
  use_complexheatmap = FALSE,
  ...
)
}
\arguments{
\item{pathway_results}{Output from analyze_pathways() or pathway scores matrix}

\item{metadata}{Sample metadata for annotations (optional if included in pathway_results)}

\item{top_n}{Number of top significant pathways to include (default: 20)}

\item{cluster_rows}{Cluster pathways (default: TRUE)}

\item{cluster_cols}{Cluster samples (default: TRUE)}

\item{annotation_cols}{Column names in metadata to use for sample annotations}

\item{color_scheme}{Color scheme: "RdBu", "viridis", "RdYlBu" (default: "RdBu")}

\item{scale}{Scale data: "row", "column", "none" (default: "row")}

\item{show_pathway_names}{Show pathway names (default: TRUE)}

\item{fontsize_row}{Font size for pathway names (default: 8)}

\item{fontsize_col}{Font size for sample names (default: 8)}

\item{use_complexheatmap}{Use ComplexHeatmap instead of pheatmap (default: FALSE)}

\item{...}{Additional arguments passed to heatmap function}
}
\value{
A heatmap plot object (grob for pheatmap, HeatmapList for ComplexHeatmap)
}
\description{
Creates heatmaps of pathway activity scores with sample annotations,
clustering, and customizable features for exploring pathway-level
expression patterns.
}
\details{
**Input Types:**
- pathway_results: Output from analyze_pathways() containing pathway scores
- Matrix: Direct pathway scores matrix (pathways x samples)

**Clustering:**
- Hierarchical clustering reveals pathway modules and sample groups
- Distance metrics: correlation (default), euclidean, manhattan
- Linkage methods: complete (default), average, single, ward

**Scaling:**
- Row scaling: Z-score normalization across samples for each pathway
- Column scaling: Z-score normalization across pathways for each sample
- No scaling: Raw pathway scores

**Annotations:**
- Sample annotations from metadata
- Automatic color assignment for categorical variables
- Numeric variables shown as continuous color gradients

**Color Schemes:**
- RdBu: Red-white-blue, good for centered data
- viridis: Perceptually uniform, colorblind-friendly
- RdYlBu: Red-yellow-blue, good for diverging data
}
\examples{
# Basic pathway heatmap
pathway_results <- analyze_pathways(...)
plot_pathway_heatmap(pathway_results, top_n = 30)

# With sample annotations
plot_pathway_heatmap(
  pathway_results,
  annotation_cols = c("condition", "batch"),
  top_n = 25,
  color_scheme = "viridis"
)

# Using ComplexHeatmap for advanced features
plot_pathway_heatmap(
  pathway_results,
  use_complexheatmap = TRUE,
  annotation_cols = "condition",
  cluster_rows = TRUE,
  cluster_cols = FALSE
)

# Direct matrix input
pathway_scores <- score_pathway_activity(...)
plot_pathway_heatmap(
  pathway_scores,
  metadata = sample_metadata,
  annotation_cols = "treatment"
)

}
\seealso{
\code{\link{analyze_pathways}}, \code{\link{score_pathway_activity}}
}
