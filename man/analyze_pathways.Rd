% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze_pathways.R
\name{analyze_pathways}
\alias{analyze_pathways}
\title{Pathway-level Differential Expression Analysis}
\usage{
analyze_pathways(
  counts,
  metadata,
  design,
  contrast = NULL,
  pathways = "Hallmark",
  species = "human",
  scoring_method = "GSVA",
  de_method = "limma",
  min_pathway_size = 5,
  max_pathway_size = 500,
  transform_method = "log2",
  alpha = 0.05,
  ...
)
}
\arguments{
\item{counts}{A matrix of raw counts (genes x samples)}

\item{metadata}{A data.frame containing sample information}

\item{design}{A formula specifying the design matrix}

\item{contrast}{Character vector of length 3: c("variable", "level1", "level2")}

\item{pathways}{Character database name (see get_pathways()) or named list of gene sets}

\item{species}{Character, "human" or "mouse" (used when pathways is a database name)}

\item{scoring_method}{Method for pathway activity scoring: "GSVA" (default), "ssGSEA", "AUCell", "mean"}

\item{de_method}{Method for differential testing: "limma" (default), "t.test", "wilcox"}

\item{min_pathway_size}{Minimum genes required in pathway (default: 5)}

\item{max_pathway_size}{Maximum genes allowed in pathway (default: 500)}

\item{transform_method}{Count transformation before scoring: "log2", "vst", "rlog"}

\item{alpha}{Significance threshold (default: 0.05)}

\item{...}{Additional arguments passed to scoring method}
}
\value{
A list of class "functionalDE_result" containing:
  \item{results}{Data.frame with pathway-level DE statistics including:
    - pathway: Pathway name
    - n_genes: Number of genes in pathway found in data
    - genes: Comma-separated list of genes in pathway (present in data)
    - log2FoldChange: Pathway-level fold change
    - pvalue: Raw p-value
    - padj: Adjusted p-value}
  \item{pathway_scores}{Matrix of pathway activity scores}
  \item{pathways_used}{List of pathways used in analysis}
  \item{counts_transformed}{Transformed count matrix used}
  \item{metadata}{Sample metadata}
  \item{method}{Methods used (scoring and DE)}
  \item{params}{Parameters used}
  \item{summary}{Summary statistics}
}
\description{
Performs differential expression analysis at the pathway level by first
calculating pathway activity scores, then testing for differential activity
between conditions. This approach can detect coordinated changes in gene
expression that might be missed at the individual gene level.
}
\details{
**Scoring Methods:**

*GSVA (Gene Set Variation Analysis):*
- Non-parametric, rank-based method
- Good for detecting pathway-level changes
- Accounts for correlation structure
- Recommended for most analyses

*ssGSEA (single-sample GSEA):*
- Single-sample pathway enrichment scores
- Normalized enrichment scores per sample
- Good for comparing across samples

*AUCell:*
- Area Under the Curve approach
- Robust to outliers
- Good for single-cell data

*Mean Expression:*
- Simple average expression of pathway genes
- Fast and interpretable
- Good for initial exploration

**Biological Interpretation:**
- Positive log2FoldChange: Higher pathway activity in level1 vs level2
- Pathway activity represents coordinated expression changes
- Significant pathways suggest functional changes between conditions
}
\examples{
# Basic pathway analysis with Hallmark pathways
pathway_results <- analyze_pathways(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control"),
  pathways = "Hallmark",
  scoring_method = "GSVA"
)

# View results
head(pathway_results$results)
summary(pathway_results)

# With custom pathways and different scoring
custom_pathways <- get_pathways("KEGG", species = "mouse")
pathway_results <- analyze_pathways(
  counts = count_matrix,
  metadata = sample_info,
  design = ~ condition,
  contrast = c("condition", "treated", "control"),
  pathways = custom_pathways,
  scoring_method = "AUCell",
  min_pathway_size = 10
)

# Visualize pathway activity
plot_pathway_heatmap(pathway_results, top_n = 20)

}
\seealso{
\code{\link{get_pathways}}, \code{\link{score_pathway_activity}}, \code{\link{plot_pathway_heatmap}}
}
